<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- 
  설      명 : 공통코드 SQL
  작  성  자 : BS정보시스템/손승범
  작  성  일 : 2014. 01. 06.
  참      고 : 전자정부표준프레임워크 : EgovCmmnCodeManage_SQL_Mysql.xml
-->
<mapper namespace="kr.co.bsisys.com.biz.code.dao.ComCodeDao">

  <!-- <cache /> -->

  <!-- 공통코드 조회 -->
  <select id="selectComCodeList" parameterType="kr.co.bsisys.com.biz.code.vo.ComCode" resultType="kr.co.bsisys.com.biz.code.vo.ComCode">
    /* kr.co.bsisys.com.biz.code.dao.ComCodeDao.selectComCodeList */
    SELECT B.CL_CODE_NM
    ,      A.CODE_ID
    ,      A.CODE_ID_NM
    ,      A.USE_AT
    FROM   COM_CODE    A
    ,      COM_CL_CODE B
    WHERE  A.CL_CODE = B.CL_CODE
    AND    A.USE_AT = 'Y'
    <if test='searchCondition == "1"'>
    AND    A.CODE_ID LIKE CONCAT ('%', #{searchKeyword},'%')
    </if>
    <if test='searchCondition == "2"'>
    AND    A.CODE_ID_NM LIKE CONCAT ('%', #{searchKeyword},'%')
    </if>
    <if test='searchCondition == "clCode"'>
    AND    A.CL_CODE LIKE CONCAT ('%', #{searchKeyword},'%')
    </if>
    LIMIT  #{recordCountPerPage} OFFSET #{firstIndex}
  </select>
  
  <!-- 공통코드 상세 조회 -->
  <select id="selectComCodeDetail" parameterType="kr.co.bsisys.com.biz.code.vo.ComCode" resultType="kr.co.bsisys.com.biz.code.vo.ComCode">
    /* kr.co.bsisys.com.biz.code.dao.ComCodeDao.selectComCodeDetail */
    SELECT B.CL_CODE_NM
    ,      A.CL_CODE
    ,      A.CODE_ID
    ,      A.CODE_ID_NM
    ,      A.CODE_ID_DC
    ,      A.USE_AT
    FROM   COM_CODE    A
    ,      COM_CL_CODE B
    WHERE  A.CL_CODE = B.CL_CODE
    AND    A.CODE_ID = #{codeId}
  </select>
  
  <!-- 공통코드 총갯수 조회 -->
  <select id="selectComCodeCnt" parameterType="kr.co.bsisys.com.biz.code.vo.ComCode" resultType="int">
    /* kr.co.bsisys.com.biz.code.dao.ComCodeDao.selectComCodeCnt */
    SELECT COUNT(*) TOTCNT
    FROM   COM_CODE   A
    ,      COM_CL_CODE B
    WHERE  A.CL_CODE = B.CL_CODE
    <if test='searchCondition == "1"'>
    AND    A.CODE_ID LIKE CONCAT ('%', #{searchKeyword},'%')
    </if>
    <if test='searchCondition == "2"'>
    AND    A.CODE_ID_NM LIKE CONCAT ('%', #{searchKeyword},'%')
    </if>
  </select>
  
  <!-- 공통코드 등록 -->
  <insert id="insertComCode" parameterType="kr.co.bsisys.com.biz.code.vo.ComCode">
    /* kr.co.bsisys.com.biz.code.dao.ComCodeDao.insertComCode */
    INSERT 
    INTO  COM_CODE
    (     CODE_ID
    ,     CODE_ID_NM
    ,     CODE_ID_DC
    ,     CL_CODE
    ,     USE_AT
    ,     CREATEDDATE
    ,     CREATEDBY_ID
    ,     LASTMODIFIEDDATE
    ,     LASTMODIFIEDBY_ID
    )
    VALUES
    (     #{codeId}
    ,     #{codeIdNm}
    ,     #{codeIdDc}
    ,     #{clCode}
    ,     #{useAt}
    ,     sysdate()
    ,     #{createdbyId}
    ,     sysdate()
    ,     #{createdbyId}
    )
  </insert>
  
  <!-- 공통코드 수정 -->
  <update id="updateComCode" parameterType="kr.co.bsisys.com.biz.code.vo.ComCode">
    /* kr.co.bsisys.com.biz.code.dao.ComCodeDao.updateComCode */
    UPDATE COM_CODE
    SET    CODE_ID_NM        = #{codeIdNm}
    ,      CODE_ID_DC        = #{codeIdDc}
    ,      USE_AT            = #{useAt}
    ,      LASTMODIFIEDDATE  = sysdate()
    ,      LASTMODIFIEDBY_ID = #{lastmodifiedbyId}
    WHERE  CODE_ID           = #{codeId}
  </update>
  
  <!-- 공통코드 삭제 -->
  <update id="deleteComCode" parameterType="kr.co.bsisys.com.biz.code.vo.ComCode">
    /* kr.co.bsisys.com.biz.code.dao.ComCodeDao.deleteComCode */
    UPDATE COM_CODE
    SET    USE_AT  = 'N'
    WHERE  CODE_ID = #{codeId}
  </update>

</mapper>