<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- 
  설      명 : 공통분류코드 SQL
  작  성  자 : BS정보시스템/손승범
  작  성  일 : 2014. 01. 06.
  참      고 : 전자정부표준프레임워크 : EgovCmmnClCodeManage_SQL_Mysql.xml
-->
<mapper namespace="kr.co.bsisys.com.biz.code.dao.ComClCodeDao">

  <!-- 공통분류코드 조회 -->
  <select id="selectComClCodeList" parameterType="kr.co.bsisys.com.biz.code.vo.ComClCode" resultType="kr.co.bsisys.com.biz.code.vo.ComClCode">
    /* kr.co.bsisys.com.biz.code.dao.ComClCodeDao.selectComClCodeList */
    SELECT  CL_CODE
    ,       CL_CODE_NM
    ,       USE_AT
    FROM    COMTCCMMNCLCODE
    WHERE   1 = 1
    AND     USE_AT = 'Y'
    <if test='searchCondition == "1"'>
      AND   CL_CODE LIKE CONCAT ('%', #{searchKeyword},'%')
    </if>
    <if test='searchCondition == "2"'>
      AND   CL_CODE_NM LIKE CONCAT ('%', #{searchKeyword},'%')
    </if>
    LIMIT   #{recordCountPerPage} OFFSET #{firstIndex}
  </select>
  
  <!-- 공통분류코드 상세조회 -->
  <select id="selectComClCodeDetail" parameterType="kr.co.bsisys.com.biz.code.vo.ComClCode" resultType="kr.co.bsisys.com.biz.code.vo.ComClCode">
    /* kr.co.bsisys.com.biz.code.dao.ComClCodeDao.selectComClCodeDetail */
    SELECT  CL_CODE
    ,       CL_CODE_NM
    ,       CL_CODE_DC
    ,       USE_AT
    FROM    COMTCCMMNCLCODE
    WHERE   CL_CODE = #{clCode}
  </select>
  
  <!-- 공통분류코드 총갯수 조회 -->
  <select id="selectComClCodeListTotCnt" parameterType="kr.co.bsisys.com.biz.code.vo.ComClCode" resultType="int">
    /* kr.co.bsisys.com.biz.code.dao.ComClCodeDao.selectComClCodeListTotCnt */
    SELECT  COUNT(*) totcnt
    FROM    COMTCCMMNCLCODE
    WHERE   1 = 1
    <if test='searchCondition == "1"'>
      AND   CL_CODE LIKE CONCAT ('%', #{searchKeyword},'%')
    </if>
    <if test='searchCondition == "2"'>
      AND   CL_CODE_NM LIKE CONCAT ('%', #{searchKeyword},'%')
    </if>
  </select>
  
  <!-- 공통분류코드 등록 -->
  <insert id="insertComClCode" parameterType="kr.co.bsisys.com.biz.code.vo.ComClCode">
    /* kr.co.bsisys.com.biz.code.dao.ComClCodeDao.insertComClCode */
    INSERT 
    INTO  COMTCCMMNCLCODE
     (    CL_CODE
     ,    CL_CODE_NM
     ,    CL_CODE_DC
     ,    USE_AT
     ,    FRST_REGIST_PNTTM
     ,    FRST_REGISTER_ID
     ,    LAST_UPDT_PNTTM
     ,    LAST_UPDUSR_ID
     )
     VALUES
     (    #{clCode}
     ,    #{clCodeNm}
     ,    #{clCodeDc}
     ,    #{useAt}
     ,    sysdate()
     ,    #{frstRegistPnttm}
     ,    sysdate()
     ,    #{frstRegistPnttm}
     )
  </insert>
  
  <!-- 공통분류코드 수정 -->
  <update id="updateComClCode" parameterType="kr.co.bsisys.com.biz.code.vo.ComClCode">
    /* kr.co.bsisys.com.biz.code.dao.ComClCodeDao.updateComClCode */
    UPDATE COMTCCMMNCLCODE
    SET    CL_CODE_NM        = #{clCodeNm}
    ,      CL_CODE_DC        = #{clCodeDc}
    ,      USE_AT            = #{useAt}
    ,      LAST_UPDT_PNTTM  = sysdate()
    ,      LAST_UPDUSR_ID = #{lastUpdusrId}
    WHERE  CL_CODE           = #{clCode}
  </update>
  
  <!-- 공통분류코드 삭제 -->
  <delete id="deleteComClCode" parameterType="kr.co.bsisys.com.biz.code.vo.ComClCode">
    /* kr.co.bsisys.com.biz.code.dao.ComClCodeDao.deleteComClCode */
    UPDATE  COMTCCMMNCLCODE
    SET     USE_AT  = 'N'
    WHERE   CL_CODE = #{clCode}
  </delete>

</mapper>