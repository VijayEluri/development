<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- 
  설      명 : 공통코드상세 SQL
  작  성  자 : BS정보시스템/손승범
  작  성  일 : 2014. 01. 06.
  참      고 : 전자정부표준프레임워크 : EgovCmmnDetailCodeManage_SQL_Mysql.xml
-->
<mapper namespace="kr.co.bsisys.com.biz.code.dao.ComCodeDetailDao">

  <!-- 공통상세코드 조회 -->
  <select id="selectComCodeDetailList" parameterType="kr.co.bsisys.com.biz.code.vo.ComCodeDetail" resultType="kr.co.bsisys.com.biz.code.vo.ComCodeDetail">
    /* kr.co.bsisys.com.biz.code.dao.ComCodeDetailDao.selectComCodeDetailList */
    SELECT  A.CODE_ID
    ,       A.CODE
    ,       A.CODE_NM
    ,       A.USE_AT
    FROM    COM_CODE_DETAIL A
    ,       COM_CODE        B
    WHERE   B.USE_AT  = 'Y'
    AND     A.CODE_ID = B.CODE_ID
    <if test='searchCondition == "1"'>
      AND   A.CODE_ID LIKE CONCAT ('%', #{searchKeyword},'%')
    </if>
    <if test='searchCondition == "2"'>
      AND   A.CODE LIKE CONCAT ('%', #{searchKeyword},'%')
    </if>
    <if test='searchCondition == "3"'>
      AND   A.CODE_NM LIKE CONCAT ('%', #{searchKeyword},'%')
    </if>
    LIMIT  #{recordCountPerPage} OFFSET #{firstIndex}
  </select>
  
  <!-- 공통상세코드 상세조회 -->
  <select id="selectComCodeDetailDetail" parameterType="kr.co.bsisys.com.biz.code.vo.ComCodeDetail" resultType="kr.co.bsisys.com.biz.code.vo.ComCodeDetail">
    /* kr.co.bsisys.com.biz.code.dao.ComCodeDetailDao.selectComCodeDetailDetail */
    SELECT  A.CODE_ID
    ,       B.CODE_ID_NM
    ,       A.CODE
    ,       A.CODE_NM
    ,       A.CODE_DC
    ,       A.USE_AT
    FROM    COM_CODE_DETAIL A
    ,       COM_CODE        B
    WHERE   B.USE_AT  = 'Y'
    AND     A.CODE_ID = B.CODE_ID
    AND     A.CODE_ID = #{codeId}
    AND     A.CODE    = #{code}
  </select>
  
  <!-- 공통상세코드 총갯수조회 -->
  <select id="selectComCodeDetailListTotCnt" parameterType="kr.co.bsisys.com.biz.code.vo.ComCodeDetail" resultType="int">
    /* kr.co.bsisys.com.biz.code.dao.ComCodeDetailDao.selectComCodeDetailListTotCnt */
    SELECT COUNT(*) TOTCNT
    FROM   COM_CODE_DETAIL A
    ,      COM_CODE        B
    WHERE  B.USE_AT  = 'Y'
    AND    A.CODE_ID = B.CODE_ID
    <if test='searchCondition == "1"'>
      AND   A.CODE_ID LIKE CONCAT ('%', #{searchKeyword},'%')
    </if>
    <if test='searchCondition == "2"'>
      AND   A.CODE LIKE CONCAT ('%', #{searchKeyword},'%')
    </if>
    <if test='searchCondition == "3"'>
      AND   A.CODE_NM LIKE CONCAT ('%', #{searchKeyword},'%')
    </if>
  </select>
  
  <!-- 공통상세코드 등록 -->
  <insert id="insertComCodeDetail" parameterType="kr.co.bsisys.com.biz.code.vo.ComCodeDetail">
    /* kr.co.bsisys.com.biz.code.dao.ComCodeDetailDao.insertComCodeDetail */
     INSERT
     INTO  COM_CODE_DETAIL
     (     CODE_ID
     ,     CODE
     ,     CODE_NM
     ,     CODE_DC
     ,     USE_AT
     ,     CREATEDDATE
     ,     CREATEDBY_ID
     ,     LASTMODIFIEDDATE
     ,     LASTMODIFIEDBY_ID
     )
     VALUES
     (     #{codeId}
     ,     #{code}
     ,     #{codeNm}
     ,     #{codeDc}
     ,     #{useAt}
     ,     sysdate()
     ,     #{createdbyId}
     ,     sysdate()
     ,     #{createdbyId}
     )
  </insert>
  
  <!-- 공통상세코드 수정 -->
  <update id="updateComCodeDetail" parameterType="kr.co.bsisys.com.biz.code.vo.ComCodeDetail">
    /* kr.co.bsisys.com.biz.code.dao.ComCodeDetailDao.updateComCodeDetail */
    UPDATE  COM_CODE_DETAIL
    SET     CODE_NM   = #{codeNm}
    ,       CODE_DC   = #{codeDc}
    ,       USE_AT    = #{useAt}
    ,       LASTMODIFIEDDATE  = sysdate()
    ,       LASTMODIFIEDBY_ID = #{lastmodifiedbyId}
    WHERE   CODE_ID   = #{codeId}
    AND     CODE      = #{code}
  </update>
  
  <!-- 공통상세코드 삭제 -->
  <delete id="deleteComCodeDetail" parameterType="kr.co.bsisys.com.biz.code.vo.ComCodeDetail">
    /* kr.co.bsisys.com.biz.code.dao.ComCodeDetailDao.deleteComCodeDetail */
    UPDATE  COM_CODE_DETAIL
    SET     USE_AT    = 'N'
    WHERE   CODE_ID   = #{codeId}
    AND     CODE      = #{code}
  </delete>
  
</mapper>